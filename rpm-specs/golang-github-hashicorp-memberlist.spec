# Generated by go2rpm 1.8.1
# https://github.com/hashicorp/memberlist/issues/195
%ifarch x86_64
%bcond_without check
%endif
%global debug_package %{nil}

# https://github.com/hashicorp/memberlist
%global goipath         github.com/hashicorp/memberlist
Version:                0.4.0

%gometa

%global common_description %{expand:
Memberlist is a Go library that manages cluster membership and member failure
detection using a gossip based protocol.

The use cases for such a library are far-reaching: all distributed systems
require membership, and memberlist is a re-usable solution to managing cluster
membership and node failure detection.

memberlist is eventually consistent but converges quickly on average. The speed
at which it converges can be heavily tuned via various knobs on the protocol.
Node failures are detected and network partitions are partially tolerated by
attempting to communicate to potentially dead nodes through multiple routes.}

%global golicenses      LICENSE
%global godocs          README.md todo.md

Name:           %{goname}
Release:        %autorelease
Summary:        Golang package for gossip based membership and failure detection

License:        MPL-2.0
URL:            %{gourl}
Source:         %{gosource}

%description %{common_description}

%gopkg

%prep
%goprep

%generate_buildrequires
%go_generate_buildrequires

%install
%gopkginstall

%if %{with check}
%check
for test in "TestMemberList_ProbeNode_Awareness_MissedNack" \
            "TestMemberlist_JoinShutdown" \
            "TestMemberlist_PingDelegate" \
; do
awk -i inplace '/^func.*'"$test"'/ { print; print "\tt.Skip(\"disabled failing test\")"; next}1' $(grep -rl $test)
done
%gocheck
%endif

%gopkgfiles

%changelog
%autochangelog
