# Generated by go2rpm 1.9.0
%bcond_without check

# https://github.com/go-jose/go-jose
%global goipath         github.com/go-jose/go-jose/v3
Version:                3.0.0

%gometa -f

%global common_description %{expand:
An implementation of JOSE standards (JWE, JWS, JWT) in Go.}

%global golicenses      LICENSE LICENSE-json
%global godocs          CONTRIBUTING.md README.md

Name:           %{goname}
Release:        %autorelease
Summary:        An implementation of JOSE standards (JWE, JWS, JWT) in Go

License:        BSD-3-Clause AND Apache-2.0
URL:            %{gourl}
Source:         %{gosource}
# https://github.com/go-jose/go-jose/issues/27
Patch0:         b7b32c1007cb6e57ac14c6959f6546ca1591f591.patch

%description %{common_description}

%gopkg

%prep
%goprep
%autopatch -p1
mv json/LICENSE LICENSE-json
sed -i "s|github.com/go-jose/go-jose/jose-util|github.com/go-jose/go-jose/v3/jose-util|" $(find . -iname "*.go" -type f)

%generate_buildrequires
%go_generate_buildrequires

%build
%gobuild -o %{gobuilddir}/bin/jose-util %{goipath}/jose-util

%install
%gopkginstall
install -m 0755 -vd                     %{buildroot}%{_bindir}
install -m 0755 -vp %{gobuilddir}/bin/* %{buildroot}%{_bindir}/

%if %{with check}
%check
%gocheck
%endif

%files
%license LICENSE LICENSE-json
%doc CONTRIBUTING.md README.md
%{_bindir}/jose-util

%gopkgfiles

%changelog
%autochangelog
