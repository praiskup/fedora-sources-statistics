# Generated by go2rpm 1.8.0
#
# This specfile is licensed under:
# SPDX-License-Identifier: MIT
# License text: https://spdx.org/licenses/MIT.html
# SPDX-FileCopyrightText: 2022 Maxwell G <gotmax@e.email>
# SPDX-FileCopyrightText: Fedora Project Authors

%bcond_without check

# https://git.sr.ht/~emersion/gqlclient
%global goipath         git.sr.ht/~emersion/gqlclient
%global commit          060f7297b33e14be7f314dddddbc4898bfec8201
%global scm             git
%global topdir          gqlclient-%{commit}
%global archivename     %{topdir}
%global archiveext      tar.gz

%gometa -f

%global common_description %{expand:
gqlclient can be used as a thin GraphQL client, and can be augmented with code
generation. See the [GoDoc examples][1] for direct usage.

[1]: https://godocs.io/git.sr.ht/~emersion/gqlclient#example-Client-Execute}

%global golicenses      LICENSE
%global godocs          README.md

Name:           %{goname}
Version:        0
Release:        %autorelease -p
Summary:        A GraphQL client and code generator for Go

License:        MIT
URL:            %{gourl}
# The forge macros don't support Sourcehut.
# https://src.fedoraproject.org/rpms/redhat-rpm-config/pull-request/209
Source:         %{gourl}/archive/%{commit}.tar.gz#/gqlclient-%{commit}.tar.gz

%description %{common_description}

%gopkg

%prep
%goprep

%generate_buildrequires
%go_generate_buildrequires

%build
for cmd in cmd/* ; do
  %gobuild -o %{gobuilddir}/bin/$(basename $cmd) %{goipath}/$cmd
done

%install
%gopkginstall
install -m 0755 -vd                     %{buildroot}%{_bindir}
install -m 0755 -vp %{gobuilddir}/bin/* %{buildroot}%{_bindir}/

%if %{with check}
%check
%gocheck
%endif

%files
%license LICENSE
%doc README.md
%{_bindir}/{gqlclient,gqlintrospect,gqlclientgen}

%gopkgfiles

%changelog
%autochangelog
