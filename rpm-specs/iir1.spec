Name:           iir1
Version:        1.9.5
Release:        %autorelease
Summary:        DSP IIR Realtime C++ filter library

License:        MIT
URL:            https://berndporr.github.io/iir1/
Source:         https://github.com/berndporr/iir1/archive/%{version}/%{name}-%{version}.tar.gz

BuildRequires:  cmake
BuildRequires:  doxygen
BuildRequires:  gcc-c++

# Not needed for multilib
ExcludeArch: %{ix86}


%description
An infinite impulse response (IIR) filter library for Linux, Mac OSX and Windows
which implements Butterworth, RBJ, Chebychev filters and can easily import
coefficients generated by Python (scipy).

The filter processes the data sample by sample for realtime processing.

It uses templates to allocate the required memory so that it can run without any
malloc / new commands. Memory is allocated at compile time so that there is
never the risk of memory leaks.

All realtime filter code is in the header files which guarantees efficient
integration into the main program and the compiler can optimise both filter code
and main program at the same time.


%package devel
Summary:        Development libraries and header files for %{name}
Requires:       %{name}%{?_isa} = %{?epoch:%{epoch}:}%{version}-%{release}
Requires:       cmake-filesystem


%description devel
%{summary}.


%package devel-doc
Summary:        Development documentation for %{name}
Requires:       %{name}-devel = %{version}-%{release}
BuildArch:      noarch


%description devel-doc
%{summary}.


%prep
%autosetup
# Source contains prebuilt documentation, need to rebuild.
rm -rf docs

%build
%cmake -DIIR1_INSTALL_STATIC=OFF
%cmake_build
# Rebuild documentation
(cat Doxyfile; echo GENERATE_LATEX = NO ) | doxygen -


%install
%cmake_install


%check
%ctest


%files
%{_libdir}/libiir.so.1*
%license COPYING

%files devel
%{_includedir}/Iir.h
%{_includedir}/iir
%{_libdir}/libiir.so
%{_libdir}/cmake/iir 
%{_libdir}/pkgconfig/iir.pc

%files devel-doc
%doc README.md
%doc title.png
%doc demo
%doc docs

%changelog
%autochangelog
